<ion-header>
  <ion-navbar>
    <ion-title>
      Colisage
    </ion-title>
    <button menuToggle>Toggle Menu</button>
  </ion-navbar>
</ion-header>


<ion-content padding>



  <form (ngSubmit)="addIt(model)">
    <ion-item>
      <ion-label>Scan</ion-label>
      <ion-input [(ngModel)]="model.scanned" name="scanned" placeholder="Scan something"></ion-input>
    </ion-item>
  </form>

    <ion-list>
      <ion-item *ngFor="let product of pack.products">
        <ion-badge>{{ product.stateMachine.state }}</ion-badge>
        {{product.name}}
      </ion-item>
    </ion-list>
  <ion-item>
    <ion-label>Weight</ion-label>
    <ion-input [(ngModel)]="model.weight" name="weight" placeholder="Package weight" type="number" required></ion-input>
  </ion-item>

  <ion-item>
    <ion-buttons start>
      <button (click)="reset()" danger>Reset</button>
    </ion-buttons>

    <ion-buttons end>
      <button (click)="validate()" primary>Make package
          <ion-icon name="send"></ion-icon>
        </button>
    </ion-buttons>
  </ion-item>

 <ion-list *ngIf="pack.shipment">
      <p>Next step for {{ pack.shipment.name }} : <button outline>{{ nextStep }}</button></p>
        <ion-card>
          <ion-item>
            Products
            <ion-icon></ion-icon>
          </ion-item>
          <ion-card-content>
            <ion-item *ngFor="let product of pack.shipment.products">
              {{ product.name }}
               - <span [ngSwitch]="product.stateMachine.state">
                 <span *ngSwitchCase="'colisé'">√</span>
                 <span *ngSwitchCase="'init'">?</span>
                 <span *ngSwitchCase="'receptionné'">?</span>
               </span>
               - <button outline>{{ product.nextSteps() }}</button>
            </ion-item>
          </ion-card-content>
        </ion-card>

        <ion-card>
          <ion-item>
            Packs
          </ion-item>
          <ion-card-content>
            <ion-item *ngFor="let pack of pack.shipment.packs">
              <a href="#" (click)="openPack(pack)">{{ pack.name }}</a> - {{ pack.stateMachine?.state }} - {{ pack.locationSM?.state }} - <button outline>{{ pack.nextSteps() }}</button>
            </ion-item>
          </ion-card-content>
        </ion-card>

</ion-list>
 <div *ngIf="!pack.shipment">
    Pas de shipment for pack
  </div>

</ion-content>
